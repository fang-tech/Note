# 网络层: 数据平面

## 4.1 导论

### 转发

从合适的端口从哪个端口出

- 是个局部的功能
- 类比于旅行是决定了单个路口我该怎么走

### 路由

由算法决定分组从发送主机到目标接收主机的路径

- 是个全局的功能
- 规划了从源地点到目的地的整体的路径

### 数据平面

- 本地, 每个路由器的功能
- 通过路由表得出输入端口到达的分组该如何转发到输出端口
- 转发功能
  - 传统方法 : 基于目标的地址ip + 转发表实现
  - SDN方式 : 基于多个字段 + 流表 => 能对分组做出的行为是更多的, 转发, 泛洪, 阻塞, 修改某些字段等动作
    - 流表则由远程服务器实现, 通过SDN方式, 网络变得可编程了

### 控制平面

- 网络范围内的逻辑
- 计算出来的路由表的是控制平面
  - 传统的控制平面, 路由器算法是在路由器内实现
  - SDN方式(software-defined networking)

> - 传统方式下, 控制平面和数据平面紧耦合在一台设备上, 同时是分布式的, 每个路由器独立完成工作
>   - 很难改动
> - SDN方式 : 逻辑集中的控制平面, 通过远程控制器与本地的控制代理交互 (CAs), 给分组交换器计算出不同的流表, 再让路由器根据流表转发
>   - 集中式且可编程

### 网络服务模型

对单个数据报的服务

- 可靠传送
- 延迟保证, 如少于40ms的延迟

对数据报流的服务

- 保序
- 带宽的保证
- 分组之间的延迟差

所以一个网络服务我们可以通过一系列的指标衡量, 以区分出来不同的模型

- 网络架构, 带宽, 丢失, 保序, 延迟, 拥塞的反馈
- 什么都不提供的是 best effort 尽力而为的网络模型

## 4.2 路由器组成



## 4.3 IP: Internet Protocol

### 数据报格式

### 分片

### IPv4地址

### NAT: 网络地址转换

### IPv6

## 4.4 通用转发和SDN